<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Hrack Mines</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: 'Arial', sans-serif; background-color: #f4f4f9; color: #333; text-align: center; padding: 20px; }
        h1 { font-size: 2.5em; margin-bottom: 20px; color: #4CAF50; }
        h2 { font-size: 1.8em; margin: 20px 0 15px; color: #555; }
        .container { max-width: 900px; margin: 0 auto; padding: 20px; background: #fff; border-radius: 10px; box-shadow: 0 4px 10px rgba(0,0,0,0.1); }
        .grid { display: grid; grid-template-columns: repeat(5, 60px); grid-gap: 10px; justify-content: center; margin-bottom: 20px; }
        .square { width: 60px; height: 60px; display: flex; justify-content: center; align-items: center; font-size: 18px; font-weight: bold; background-color: #e0e0e0; border-radius: 10px; border: 1px solid #ccc; cursor: pointer; transition: background-color 0.2s ease, transform 0.2s ease; }
        .square:hover { background-color: #ddd; transform: scale(1.1); }
        .bomb { background-color: #f44336; color: white; font-size: 24px; }
        .green { background-color: #4CAF50; color: white; }
        .yellow { background-color: #FFEB3B; color: black; }
        .red { background-color: #FF5722; color: white; }
        .controls { margin-bottom: 30px; }
        .controls label { font-size: 16px; display: block; margin-bottom: 8px; }
        .controls input[type="number"] { padding: 10px; font-size: 16px; border-radius: 5px; border: 1px solid #ccc; width: 100px; text-align: center; }
        button { padding: 12px 25px; font-size: 16px; margin: 10px 5px; background-color: #4CAF50; color: white; border: none; border-radius: 8px; cursor: pointer; transition: background-color 0.3s ease; }
        button:hover { background-color: #45a049; transform: scale(1.05); }
        .footer { margin-top: 20px; font-size: 14px; color: #888; }
    </style>
</head>
<body>
    <div class="container">
        <h1>Hrack Mines</h1>
        <div class="controls">
            <h2>Configura√ß√µes</h2>
            <label for="bombCountInput">N√∫mero de bombas (1-24):</label>
            <input type="number" id="bombCountInput" min="1" max="24" value="3" />
            <div>
                <button id="randomMarkButton">Marcar Aleatoriamente</button>
                <button id="playUntilPercentageButton">Play at√© 1 Quadrado Verde</button>
            </div>
        </div>
        <div>
            <h2>Tabuleiro de Marca√ß√µes</h2>
            <div class="grid" id="markGrid"></div>
        </div>
        <div id="finalContainer" style="display: none;">
            <h2>Tabuleiro Final</h2>
            <div class="grid" id="finalGrid"></div>
        </div>
        <div class="footer">¬© 2024 Hrack Mines - Desenvolvido para divers√£o!</div>
    </div>

    <script>
        const markGrid = document.getElementById("markGrid"),
              finalGrid = document.getElementById("finalGrid"),
              bombCountInput = document.getElementById("bombCountInput"),
              randomMarkButton = document.getElementById("randomMarkButton"),
              playUntilPercentageButton = document.getElementById("playUntilPercentageButton");

        let markSquares = [], markedBombs = [], squareCount = 25, bombAttempts = [], attempt = 0;

        // Inicializa o tabuleiro de marca√ß√µes
        function initializeMarkBoard() {
            markSquares = [];
            markedBombs = [];
            bombAttempts = [];
            markGrid.innerHTML = "";
            for (let i = 0; i < squareCount; i++) {
                const square = document.createElement("div");
                square.classList.add("square");
                square.addEventListener("click", () => handleMarkSquareClick(square, i));
                markGrid.appendChild(square);
                markSquares.push(square);
            }
        }

        // Clique no tabuleiro de marca√ß√µes
        function handleMarkSquareClick(square, index) {
            const bombCount = parseInt(bombCountInput.value);
            if (markedBombs.includes(index)) {
                square.classList.remove("bomb");
                square.textContent = "";
                markedBombs = markedBombs.filter(e => e !== index);
            } else if (markedBombs.length < bombCount) {
                square.classList.add("bomb");
                square.textContent = "üí£";
                markedBombs.push(index);
            }
        }

        // Gera√ß√£o aleat√≥ria de bombas
        function generateRandomMarks() {
            initializeMarkBoard();
            const bombCount = parseInt(bombCountInput.value);
            const positions = [...Array(squareCount).keys()];
            shuffleArray(positions);
            for (let i = 0; i < bombCount; i++) {
                const randomIndex = positions[i];
                markedBombs.push(randomIndex);
                markSquares[randomIndex].classList.add("bomb");
                markSquares[randomIndex].textContent = "üí£";
            }
        }

        // Movimenta bombas at√© que reste 1 quadrado verde
        function moveBombsUntilPercentage() {
            attempt = 0;
            const interval = setInterval(() => {
                attempt++;
                const positions = [...Array(squareCount).keys()];
                shuffleArray(positions);

                bombAttempts = Array(squareCount).fill(0);
                for (let i = 0; i < markedBombs.length; i++) {
                    bombAttempts[positions[i]]++;
                }

                if (Math.min(...bombAttempts) === 1) {
                    clearInterval(interval);
                    finalizeGame();
                }
            }, 100);
        }

        // Embaralha um array
        function shuffleArray(array) {
            for (let i = array.length - 1; i > 0; i--) {
                const randomIndex = Math.floor(Math.random() * (i + 1));
                [array[i], array[randomIndex]] = [array[randomIndex], array[i]];
            }
        }

        // Finaliza o jogo
        function finalizeGame() {
            finalGrid.innerHTML = "";
            bombAttempts.forEach((count, index) => {
                const square = document.createElement("div");
                square.classList.add("square");
                square.textContent = count;
                finalGrid.appendChild(square);
            });
        }

        // Inicializa√ß√£o
        window.onload = () => initializeMarkBoard();

        // Eventos dos bot√µes
        randomMarkButton.addEventListener("click", generateRandomMarks);
        playUntilPercentageButton.addEventListener("click", moveBombsUntilPercentage);
    </script>
</body>
</html>